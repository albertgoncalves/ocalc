#!/usr/bin/env bash

set -eu

build () {
    home=$(pwd)
    cd $WD/src/
    ocamllex lexer.mll      # generates lexer.ml
    menhir parser.mly       # generates parser.ml and parser.mli
    ocamlc -c parser.mli
    ocamlc exceptions.ml lexer.ml parser.ml main.ml -o "$WD/bin/main"
    cd $home
}

build
echo "./bin/main"
rlwrap $WD/bin/main
